Plus
  ::= "+" as Plus
  ;

EqualOptional
  ::= "optional" [Plus:optional] "+" {Plus:loop} as OptionalFeature {priority = Equal}
  ;

PositiveOptional
  ::= "positive_optional" +[Plus:optional] "+" {Plus:loop} as OptionalFeature {priority = PreferTake}
  ;

NegativeOptional
  ::= "negative_optional" -[Plus:optional] "+" {Plus:loop} as OptionalFeature {priority = PreferSkip}
  ;

NO1
  ::= [Plus:optional] Plus:tail1 as partial NestedOptionalFeature
  ;

PositiveNO1
  ::= +[Plus:optional] Plus:tail1 as partial NestedOptionalFeature
  ;

NegativeNO1
  ::= -[Plus:optional] Plus:tail1 as partial NestedOptionalFeature
  ;

NO2
  ::= [NO1] Plus:tail2 as partial NestedOptionalFeature
  ;

PositiveNO2
  ::= +[PositiveNO1] Plus:tail2 as partial NestedOptionalFeature
  ;

NegativeNO2
  ::= -[NegativeNO1] Plus:tail2 as partial NestedOptionalFeature
  ;

NestedOptional
  ::= "nested_optional" [NO2] Plus:tail3 {Plus:tails} as NestedOptionalFeature
  ;

NestedPositiveOptional
  ::= "nested_positive_optional" +[PositiveNO2] Plus:tail3 {Plus:tails} as NestedOptionalFeature
  ;

NestedNegativeOptional
  ::= "nested_negative_optional" -[NegativeNO2] Plus:tail3 {Plus:tails} as NestedOptionalFeature
  ;

BranchedOptional
  ::= "branched_optional" +[Plus:first] +[Plus:second] Plus as BranchedOptionalFeature {type = PlusPlus}
  ::= "branched_optional" +[Plus:first] -[Plus:second] Plus as BranchedOptionalFeature {type = PlusMinus}
  ::= "branched_optional" -[Plus:first] +[Plus:second] Plus as BranchedOptionalFeature {type = MinusPlus}
  ::= "branched_optional" -[Plus:first] -[Plus:second] Plus as BranchedOptionalFeature {type = MinusMinus}
  ;

Module
  ::= !EqualOptional
  ::= !PositiveOptional
  ::= !NegativeOptional
  ::= !NestedOptional
  ::= !NestedPositiveOptional
  ::= !NestedNegativeOptional
  ::= !BranchedOptional
  ;
